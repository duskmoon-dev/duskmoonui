---
interface Props {
  path?: string;
}

const { path = Astro.url.pathname } = Astro.props;

interface Crumb {
  label: string;
  href: string;
}

function generateBreadcrumbs(pathname: string): Crumb[] {
  const segments = pathname.split('/').filter(Boolean);
  const breadcrumbs: Crumb[] = [
    { label: 'Home', href: '/' }
  ];

  let currentPath = '';

  segments.forEach((segment, index) => {
    currentPath += `/${segment}`;

    // Format label (replace hyphens, capitalize)
    let label = segment
      .split('-')
      .map(word => word.charAt(0).toUpperCase() + word.slice(1))
      .join(' ');

    // Handle special cases
    if (segment === 'en') return; // Skip language segment
    if (segment === 'docs') label = 'Documentation';
    if (segment === 'api') label = 'API';

    breadcrumbs.push({
      label,
      href: currentPath
    });
  });

  return breadcrumbs;
}

const breadcrumbs = generateBreadcrumbs(path);
---

{breadcrumbs.length > 1 && (
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    <ol class="breadcrumb-list">
      {breadcrumbs.map((crumb, index) => (
        <li class="breadcrumb-item">
          {index < breadcrumbs.length - 1 ? (
            <>
              <a href={crumb.href} class="breadcrumb-link">
                {crumb.label}
              </a>
              <svg class="breadcrumb-separator" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </>
          ) : (
            <span class="breadcrumb-current">{crumb.label}</span>
          )}
        </li>
      ))}
    </ol>
  </nav>
)}
